
AVRASM ver. 2.1.52  D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\LittleThermo.asm Mon Dec 15 00:14:24 2014

[builtin](2): Including file 'C:\Program Files (x86)\Atmel\Atmel Toolchain\AVR Assembler\Native\2.1.1117\avrassembler\Include\tn13def.inc'
D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\LittleThermo.asm(8): Including file 'D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\avr.inc'
D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\LittleThermo.asm(174): Including file 'D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\1-wire.asm'
D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\1-wire.asm(24): Including file 'D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\wait.asm'
D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\1-wire.asm(168): Including file 'D:\Workshop\AVR\LittleThermo\LittleThermo\LittleThermo\1-Wire Search.asm'
                 
                 /*
                 
                 ;***** Created: 2011-02-09 12:03 ******* Source: ATtiny13.xml ************
                 ;*************************************************************************
                 ;* A P P L I C A T I O N   N O T E   F O R   T H E   A V R   F A M I L Y
                 ;* 
                 ;* Number            : AVR000
                 ;* File Name         : "tn13def.inc"
                 ;* Title             : Register/Bit Definitions for the ATtiny13
                 ;* Date              : 2011-02-09
                 ;* Version           : 2.35
                 ;* Support E-mail    : avr@atmel.com
                 ;* Target MCU        : ATtiny13
                 ;* 
                 ;* DESCRIPTION
                 ;* When including this file in the assembly program file, all I/O register 
                 ;* names and I/O register bit names appearing in the data book can be used.
                 ;* In addition, the six registers forming the three data pointers X, Y and 
                 ;* Z have been assigned names XL - ZH. Highest RAM address for Internal 
                 ;* SRAM is also defined 
                 ;* 
                 ;* The Register names are represented by their hexadecimal address.
                 ;* 
                 ;* The Register Bit names are represented by their bit number (0-7).
                 ;* 
                 ;* Please observe the difference in using the bit names with instructions
                 ;* such as "sbr"/"cbr" (set/clear bit in register) and "sbrs"/"sbrc"
                 ;* (skip if bit in register set/cleared). The following example illustrates
                 ;* this:
                 ;* 
                 ;* in    r16,PORTB             ;read PORTB latch
                 ;* sbr   r16,(1<<PB6)+(1<<PB5) ;set PB6 and PB5 (use masks, not bit#)
                 ;* out   PORTB,r16             ;output to PORTB
                 ;* 
                 ;* in    r16,TIFR              ;read the Timer Interrupt Flag Register
                 ;* sbrc  r16,TOV0              ;test the overflow flag (use bit#)
                 ;* rjmp  TOV0_is_set           ;jump if set
                 ;* ...                         ;otherwise do something else
                 ;*************************************************************************
                 
                 #ifndef _TN13DEF_INC_
                 #define _TN13DEF_INC_
                 
                 
                 #pragma partinc 0
                 
                 ; ***** SPECIFY DEVICE ***************************************************
                 .device ATtiny13
                 #pragma AVRPART ADMIN PART_NAME ATtiny13
                 .equ	SIGNATURE_000	= 0x1e
                 .equ	SIGNATURE_001	= 0x90
                 .equ	SIGNATURE_002	= 0x07
                 
                 #pragma AVRPART CORE CORE_VERSION V2
                 #pragma AVRPART CORE NEW_INSTRUCTIONS lpm rd,z+
                 
                 
                 ; ***** I/O REGISTER DEFINITIONS *****************************************
                 ; NOTE:
                 ; Definitions marked "MEMORY MAPPED"are extended I/O ports
                 ; and cannot be used with IN/OUT instructions
                 .equ	SREG	= 0x3f
                 .equ	SPL	= 0x3d
                 .equ	GIMSK	= 0x3b
                 .equ	GIFR	= 0x3a
                 .equ	TIMSK0	= 0x39
                 .equ	TIFR0	= 0x38
                 .equ	SPMCSR	= 0x37
                 .equ	OCR0A	= 0x36
                 .equ	MCUCR	= 0x35
                 .equ	MCUSR	= 0x34
                 .equ	TCCR0B	= 0x33
                 .equ	TCNT0	= 0x32
                 .equ	OSCCAL	= 0x31
                 .equ	TCCR0A	= 0x2f
                 .equ	DWDR	= 0x2e
                 .equ	OCR0B	= 0x29
                 .equ	GTCCR	= 0x28
                 .equ	CLKPR	= 0x26
                 .equ	WDTCR	= 0x21
                 .equ	EEAR	= 0x1e
                 .equ	EEDR	= 0x1d
                 .equ	EECR	= 0x1c
                 .equ	PORTB	= 0x18
                 .equ	DDRB	= 0x17
                 .equ	PINB	= 0x16
                 .equ	PCMSK	= 0x15
                 .equ	DIDR0	= 0x14
                 .equ	ACSR	= 0x08
                 .equ	ADMUX	= 0x07
                 .equ	ADCSRA	= 0x06
                 .equ	ADCH	= 0x05
                 .equ	ADCL	= 0x04
                 .equ	ADCSRB	= 0x03
                 
                 
                 ; ***** BIT DEFINITIONS **************************************************
                 
                 ; ***** AD_CONVERTER *****************
                 ; ADMUX - The ADC multiplexer Selection Register
                 .equ	MUX0	= 0	; Analog Channel and Gain Selection Bits
                 .equ	MUX1	= 1	; Analog Channel and Gain Selection Bits
                 .equ	ADLAR	= 5	; Left Adjust Result
                 .equ	REFS0	= 6	; Reference Selection Bit 0
                 
                 ; ADCSRA - The ADC Control and Status register
                 .equ	ADPS0	= 0	; ADC  Prescaler Select Bits
                 .equ	ADPS1	= 1	; ADC  Prescaler Select Bits
                 .equ	ADPS2	= 2	; ADC  Prescaler Select Bits
                 .equ	ADIE	= 3	; ADC Interrupt Enable
                 .equ	ADIF	= 4	; ADC Interrupt Flag
                 .equ	ADATE	= 5	; ADC Auto Trigger Enable
                 .equ	ADSC	= 6	; ADC Start Conversion
                 .equ	ADEN	= 7	; ADC Enable
                 
                 ; ADCH - ADC Data Register High Byte
                 .equ	ADCH0	= 0	; ADC Data Register High Byte Bit 0
                 .equ	ADCH1	= 1	; ADC Data Register High Byte Bit 1
                 .equ	ADCH2	= 2	; ADC Data Register High Byte Bit 2
                 .equ	ADCH3	= 3	; ADC Data Register High Byte Bit 3
                 .equ	ADCH4	= 4	; ADC Data Register High Byte Bit 4
                 .equ	ADCH5	= 5	; ADC Data Register High Byte Bit 5
                 .equ	ADCH6	= 6	; ADC Data Register High Byte Bit 6
                 .equ	ADCH7	= 7	; ADC Data Register High Byte Bit 7
                 
                 ; ADCL - ADC Data Register Low Byte
                 .equ	ADCL0	= 0	; ADC Data Register Low Byte Bit 0
                 .equ	ADCL1	= 1	; ADC Data Register Low Byte Bit 1
                 .equ	ADCL2	= 2	; ADC Data Register Low Byte Bit 2
                 .equ	ADCL3	= 3	; ADC Data Register Low Byte Bit 3
                 .equ	ADCL4	= 4	; ADC Data Register Low Byte Bit 4
                 .equ	ADCL5	= 5	; ADC Data Register Low Byte Bit 5
                 .equ	ADCL6	= 6	; ADC Data Register Low Byte Bit 6
                 .equ	ADCL7	= 7	; ADC Data Register Low Byte Bit 7
                 
                 ; ADCSRB - ADC Control and Status Register B
                 .equ	ADTS0	= 0	; ADC Auto Trigger Source 0
                 .equ	ADTS1	= 1	; ADC Auto Trigger Source 1
                 .equ	ADTS2	= 2	; ADC Auto Trigger Source 2
                 
                 ; DIDR0 - Digital Input Disable Register 0
                 .equ	ADC1D	= 2	; ADC2 Digital input Disable
                 .equ	ADC3D	= 3	; ADC3 Digital input Disable
                 .equ	ADC2D	= 4	; ADC2 Digital input Disable
                 .equ	ADC0D	= 5	; ADC0 Digital input Disable
                 
                 
                 ; ***** ANALOG_COMPARATOR ************
                 ; ADCSRB - ADC Control and Status Register B
                 .equ	ACME	= 6	; Analog Comparator Multiplexer Enable
                 
                 ; ACSR - Analog Comparator Control And Status Register
                 .equ	ACIS0	= 0	; Analog Comparator Interrupt Mode Select bit 0
                 .equ	ACIS1	= 1	; Analog Comparator Interrupt Mode Select bit 1
                 .equ	ACIE	= 3	; Analog Comparator Interrupt Enable
                 .equ	ACI	= 4	; Analog Comparator Interrupt Flag
                 .equ	ACO	= 5	; Analog Compare Output
                 .equ	ACBG	= 6	; Analog Comparator Bandgap Select
                 .equ	AINBG	= ACBG	; For compatibility
                 .equ	ACD	= 7	; Analog Comparator Disable
                 
                 ; DIDR0 - 
                 .equ	AIN0D	= 0	; AIN0 Digital Input Disable
                 .equ	AIN1D	= 1	; AIN1 Digital Input Disable
                 
                 
                 ; ***** EEPROM ***********************
                 ; EEAR - EEPROM Read/Write Access
                 .equ	EEARL	= EEAR	; For compatibility
                 .equ	EEAR0	= 0	; EEPROM Read/Write Access bit 0
                 .equ	EEAR1	= 1	; EEPROM Read/Write Access bit 1
                 .equ	EEAR2	= 2	; EEPROM Read/Write Access bit 2
                 .equ	EEAR3	= 3	; EEPROM Read/Write Access bit 3
                 .equ	EEAR4	= 4	; EEPROM Read/Write Access bit 4
                 .equ	EEAR5	= 5	; EEPROM Read/Write Access bit 5
                 
                 ; EEDR - EEPROM Data Register
                 .equ	EEDR0	= 0	; EEPROM Data Register bit 0
                 .equ	EEDR1	= 1	; EEPROM Data Register bit 1
                 .equ	EEDR2	= 2	; EEPROM Data Register bit 2
                 .equ	EEDR3	= 3	; EEPROM Data Register bit 3
                 .equ	EEDR4	= 4	; EEPROM Data Register bit 4
                 .equ	EEDR5	= 5	; EEPROM Data Register bit 5
                 .equ	EEDR6	= 6	; EEPROM Data Register bit 6
                 .equ	EEDR7	= 7	; EEPROM Data Register bit 7
                 
                 ; EECR - EEPROM Control Register
                 .equ	EERE	= 0	; EEPROM Read Enable
                 .equ	EEWE	= 1	; EEPROM Write Enable
                 .equ	EEPE	= EEWE	; For compatibility
                 .equ	EEMWE	= 2	; EEPROM Master Write Enable
                 .equ	EEMPE	= EEMWE	; For compatibility
                 .equ	EERIE	= 3	; EEProm Ready Interrupt Enable
                 .equ	EEPM0	= 4	; 
                 .equ	EEPM1	= 5	; 
                 
                 
                 ; ***** CPU **************************
                 ; SREG - Status Register
                 .equ	SREG_C	= 0	; Carry Flag
                 .equ	SREG_Z	= 1	; Zero Flag
                 .equ	SREG_N	= 2	; Negative Flag
                 .equ	SREG_V	= 3	; Two's Complement Overflow Flag
                 .equ	SREG_S	= 4	; Sign Bit
                 .equ	SREG_H	= 5	; Half Carry Flag
                 .equ	SREG_T	= 6	; Bit Copy Storage
                 .equ	SREG_I	= 7	; Global Interrupt Enable
                 
                 ; SPL - Stack Pointer Low Byte
                 .equ	SP0	= 0	; Stack Pointer Bit 0
                 .equ	SP1	= 1	; Stack Pointer Bit 1
                 .equ	SP2	= 2	; Stack Pointer Bit 2
                 .equ	SP3	= 3	; Stack Pointer Bit 3
                 .equ	SP4	= 4	; Stack Pointer Bit 4
                 .equ	SP5	= 5	; Stack Pointer Bit 5
                 .equ	SP6	= 6	; Stack Pointer Bit 6
                 .equ	SP7	= 7	; Stack Pointer Bit 7
                 
                 ; MCUCR - MCU Control Register
                 .equ	ISC00	= 0	; Interrupt Sense Control 0 bit 0
                 .equ	ISC01	= 1	; Interrupt Sense Control 0 bit 1
                 .equ	SM0	= 3	; Sleep Mode Select Bit 0
                 .equ	SM1	= 4	; Sleep Mode Select Bit 1
                 .equ	SE	= 5	; Sleep Enable
                 .equ	PUD	= 6	; Pull-up Disable
                 
                 ; MCUSR - MCU Status register
                 .equ	PORF	= 0	; Power-On Reset Flag
                 .equ	EXTRF	= 1	; External Reset Flag
                 .equ	BORF	= 2	; Brown-out Reset Flag
                 .equ	WDRF	= 3	; Watchdog Reset Flag
                 
                 ; OSCCAL - Oscillator Calibration Register
                 .equ	CAL0	= 0	; Oscillatro Calibration Value Bit 0
                 .equ	CAL1	= 1	; Oscillatro Calibration Value Bit 1
                 .equ	CAL2	= 2	; Oscillatro Calibration Value Bit 2
                 .equ	CAL3	= 3	; Oscillatro Calibration Value Bit 3
                 .equ	CAL4	= 4	; Oscillatro Calibration Value Bit 4
                 .equ	CAL5	= 5	; Oscillatro Calibration Value Bit 5
                 .equ	CAL6	= 6	; Oscillatro Calibration Value Bit 6
                 
                 ; CLKPR - Clock Prescale Register
                 .equ	CLKPS0	= 0	; Clock Prescaler Select Bit 0
                 .equ	CLKPS1	= 1	; Clock Prescaler Select Bit 1
                 .equ	CLKPS2	= 2	; Clock Prescaler Select Bit 2
                 .equ	CLKPS3	= 3	; Clock Prescaler Select Bit 3
                 .equ	CLKPCE	= 7	; Clock Prescaler Change Enable
                 
                 ; DWDR - Debug Wire Data Register
                 .equ	DWDR0	= 0	; Debug Wire Data Register Bit 0
                 .equ	DWDR1	= 1	; Debug Wire Data Register Bit 1
                 .equ	DWDR2	= 2	; Debug Wire Data Register Bit 2
                 .equ	DWDR3	= 3	; Debug Wire Data Register Bit 3
                 .equ	DWDR4	= 4	; Debug Wire Data Register Bit 4
                 .equ	DWDR5	= 5	; Debug Wire Data Register Bit 5
                 .equ	DWDR6	= 6	; Debug Wire Data Register Bit 6
                 .equ	DWDR7	= 7	; Debug Wire Data Register Bit 7
                 
                 ; SPMCSR - Store Program Memory Control and Status Register
                 .equ	SPMEN	= 0	; Store program Memory Enable
                 .equ	PGERS	= 1	; Page Erase
                 .equ	PGWRT	= 2	; Page Write
                 .equ	RFLB	= 3	; Read Fuse and Lock Bits
                 .equ	CTPB	= 4	; Clear Temporary Page Buffer
                 
                 
                 ; ***** PORTB ************************
                 ; PORTB - Data Register, Port B
                 .equ	PORTB0	= 0	; 
                 .equ	PB0	= 0	; For compatibility
                 .equ	PORTB1	= 1	; 
                 .equ	PB1	= 1	; For compatibility
                 .equ	PORTB2	= 2	; 
                 .equ	PB2	= 2	; For compatibility
                 .equ	PORTB3	= 3	; 
                 .equ	PB3	= 3	; For compatibility
                 .equ	PORTB4	= 4	; 
                 .equ	PB4	= 4	; For compatibility
                 .equ	PORTB5	= 5	; 
                 .equ	PB5	= 5	; For compatibility
                 
                 ; DDRB - Data Direction Register, Port B
                 .equ	DDB0	= 0	; 
                 .equ	DDB1	= 1	; 
                 .equ	DDB2	= 2	; 
                 .equ	DDB3	= 3	; 
                 .equ	DDB4	= 4	; 
                 .equ	DDB5	= 5	; 
                 
                 ; PINB - Input Pins, Port B
                 .equ	PINB0	= 0	; 
                 .equ	PINB1	= 1	; 
                 .equ	PINB2	= 2	; 
                 .equ	PINB3	= 3	; 
                 .equ	PINB4	= 4	; 
                 .equ	PINB5	= 5	; 
                 
                 
                 ; ***** EXTERNAL_INTERRUPT ***********
                 ; MCUCR - MCU Control Register
                 ;.equ	ISC00	= 0	; Interrupt Sense Control 0 Bit 0
                 ;.equ	ISC01	= 1	; Interrupt Sense Control 0 Bit 1
                 
                 ; GIMSK - General Interrupt Mask Register
                 .equ	GICR	= GIMSK	; For compatibility
                 .equ	PCIE	= 5	; Pin Change Interrupt Enable
                 .equ	INT0	= 6	; External Interrupt Request 0 Enable
                 
                 ; GIFR - General Interrupt Flag register
                 .equ	PCIF	= 5	; Pin Change Interrupt Flag
                 .equ	INTF0	= 6	; External Interrupt Flag 0
                 
                 ; PCMSK - Pin Change Enable Mask
                 .equ	PCINT0	= 0	; Pin Change Enable Mask Bit 0
                 .equ	PCINT1	= 1	; Pin Change Enable Mask Bit 1
                 .equ	PCINT2	= 2	; Pin Change Enable Mask Bit 2
                 .equ	PCINT3	= 3	; Pin Change Enable Mask Bit 3
                 .equ	PCINT4	= 4	; Pin Change Enable Mask Bit 4
                 .equ	PCINT5	= 5	; Pin Change Enable Mask Bit 5
                 
                 
                 ; ***** TIMER_COUNTER_0 **************
                 ; TIMSK0 - Timer/Counter0 Interrupt Mask Register
                 .equ	TOIE0	= 1	; Timer/Counter0 Overflow Interrupt Enable
                 .equ	OCIE0A	= 2	; Timer/Counter0 Output Compare Match A Interrupt Enable
                 .equ	OCIE0B	= 3	; Timer/Counter0 Output Compare Match B Interrupt Enable
                 
                 ; TIFR0 - Timer/Counter0 Interrupt Flag register
                 .equ	TOV0	= 1	; Timer/Counter0 Overflow Flag
                 .equ	OCF0A	= 2	; Timer/Counter0 Output Compare Flag 0A
                 .equ	OCF0B	= 3	; Timer/Counter0 Output Compare Flag 0B
                 
                 ; OCR0A - Timer/Counter0 Output Compare Register
                 .equ	OCR0A_0	= 0	; 
                 .equ	OCR0A_1	= 1	; 
                 .equ	OCR0A_2	= 2	; 
                 .equ	OCR0A_3	= 3	; 
                 .equ	OCR0A_4	= 4	; 
                 .equ	OCR0A_5	= 5	; 
                 .equ	OCR0A_6	= 6	; 
                 .equ	OCR0A_7	= 7	; 
                 
                 ; TCCR0A - Timer/Counter  Control Register A
                 .equ	WGM00	= 0	; Waveform Generation Mode
                 .equ	WGM01	= 1	; Waveform Generation Mode
                 .equ	COM0B0	= 4	; Compare Match Output B Mode
                 .equ	COM0B1	= 5	; Compare Match Output B Mode
                 .equ	COM0A0	= 6	; Compare Match Output A Mode
                 .equ	COM0A1	= 7	; Compare Match Output A Mode
                 
                 ; TCNT0 - Timer/Counter0
                 .equ	TCNT0_0	= 0	; 
                 .equ	TCNT0_1	= 1	; 
                 .equ	TCNT0_2	= 2	; 
                 .equ	TCNT0_3	= 3	; 
                 .equ	TCNT0_4	= 4	; 
                 .equ	TCNT0_5	= 5	; 
                 .equ	TCNT0_6	= 6	; 
                 .equ	TCNT0_7	= 7	; 
                 
                 ; TCCR0B - Timer/Counter Control Register B
                 .equ	CS00	= 0	; Clock Select
                 .equ	CS01	= 1	; Clock Select
                 .equ	CS02	= 2	; Clock Select
                 .equ	WGM02	= 3	; Waveform Generation Mode
                 .equ	FOC0B	= 6	; Force Output Compare B
                 .equ	FOC0A	= 7	; Force Output Compare A
                 
                 ; OCR0B - Timer/Counter0 Output Compare Register
                 .equ	OCR0B_0	= 0	; 
                 .equ	OCR0B_1	= 1	; 
                 .equ	OCR0B_2	= 2	; 
                 .equ	OCR0B_3	= 3	; 
                 .equ	OCR0B_4	= 4	; 
                 .equ	OCR0B_5	= 5	; 
                 .equ	OCR0B_6	= 6	; 
                 .equ	OCR0B_7	= 7	; 
                 
                 ; GTCCR - General Timer Conuter Register
                 .equ	PSR10	= 0	; Prescaler Reset Timer/Counter0
                 .equ	TSM	= 7	; Timer/Counter Synchronization Mode
                 
                 
                 ; ***** WATCHDOG *********************
                 ; WDTCR - Watchdog Timer Control Register
                 .equ	WDP0	= 0	; Watch Dog Timer Prescaler bit 0
                 .equ	WDP1	= 1	; Watch Dog Timer Prescaler bit 1
                 .equ	WDP2	= 2	; Watch Dog Timer Prescaler bit 2
                 .equ	WDE	= 3	; Watch Dog Enable
                 .equ	WDCE	= 4	; Watchdog Change Enable
                 .equ	WDP3	= 5	; Watchdog Timer Prescaler Bit 3
                 .equ	WDTIE	= 6	; Watchdog Timeout Interrupt Enable
                 .equ	WDTIF	= 7	; Watchdog Timeout Interrupt Flag
                 
                 
                 
                 ; ***** LOCKSBITS ********************************************************
                 .equ	LB1	= 0	; Lockbit
                 .equ	LB2	= 1	; Lockbit
                 
                 
                 ; ***** FUSES ************************************************************
                 ; LOW fuse bits
                 .equ	CKSEL0	= 0	; Select Clock Source
                 .equ	CKSEL1	= 1	; Select Clock Source
                 .equ	SUT0	= 2	; Select start-up time
                 .equ	SUT1	= 3	; Select start-up time
                 .equ	CKDIV8	= 4	; Start up with system clock divided by 8
                 .equ	WDTON	= 5	; Watch dog timer always on
                 .equ	EESAVE	= 6	; Keep EEprom contents during chip erase
                 .equ	SPIEN	= 7	; SPI programming enable
                 
                 ; HIGH fuse bits
                 .equ	RSTDISBL	= 0	; Disable external reset
                 .equ	BODLEVEL0	= 1	; Enable BOD and select level
                 .equ	BODLEVEL1	= 2	; Enable BOD and select level
                 .equ	DWEN	= 3	; DebugWire Enable
                 .equ	SELFPRGEN	= 4	; Self Programming Enable
                 
                 
                 
                 ; ***** CPU REGISTER DEFINITIONS *****************************************
                 .def	XH	= r27
                 .def	XL	= r26
                 .def	YH	= r29
                 .def	YL	= r28
                 .def	ZH	= r31
                 .def	ZL	= r30
                 
                 
                 
                 ; ***** DATA MEMORY DECLARATIONS *****************************************
                 .equ	FLASHEND	= 0x01ff	; Note: Word address
                 .equ	IOEND	= 0x003f
                 .equ	SRAM_START	= 0x0060
                 .equ	SRAM_SIZE	= 64
                 .equ	RAMEND	= 0x009f
                 .equ	XRAMEND	= 0x0000
                 .equ	E2END	= 0x003f
                 .equ	EEPROMEND	= 0x003f
                 .equ	EEADRBITS	= 6
                 #pragma AVRPART MEMORY PROG_FLASH 1024
                 #pragma AVRPART MEMORY EEPROM 64
                 #pragma AVRPART MEMORY INT_SRAM SIZE 64
                 #pragma AVRPART MEMORY INT_SRAM START_ADDR 0x60
                 
                 
                 
                 ; ***** BOOTLOADER DECLARATIONS ******************************************
                 .equ	PAGESIZE	= 16
                 
                 
                 
                 ; ***** INTERRUPT VECTORS ************************************************
                 .equ	INT0addr	= 0x0001	; External Interrupt 0
                 .equ	PCI0addr	= 0x0002	; External Interrupt Request 0
                 .equ	OVF0addr	= 0x0003	; Timer/Counter0 Overflow
                 .equ	ERDYaddr	= 0x0004	; EEPROM Ready
                 .equ	ACIaddr	= 0x0005	; Analog Comparator
                 .equ	OC0Aaddr	= 0x0006	; Timer/Counter Compare Match A
                 .equ	OC0Baddr	= 0x0007	; Timer/Counter Compare Match B
                 .equ	WDTaddr	= 0x0008	; Watchdog Time-out
                 .equ	ADCCaddr	= 0x0009	; ADC Conversion Complete
                 
                 .equ	INT_VECTORS_SIZE	= 10	; size in words
                 
                 #endif  /* _TN13DEF_INC_ */
                 
                 ; ***** END OF FILE ******************************************************
                 
                  * LittleThermo.asm
                  *
                  *  Created: 16.10.2014 16:14:39
                  *   Author: vlad
                  */ 
                 
                  .include "avr.inc"
                 
                 ; Constants
                 
                 .equ	RAMTOP = 0x60
                 
                 
                 
                 .equ	bit0	= 0b00000001
                 .equ	bit1	= 0b00000010
                 .equ	bit2	= 0b00000100
                 .equ	bit3	= 0b00001000
                 .equ	bit4	= 0b00010000
                 .equ	bit5	= 0b00100000
                 .equ	bit6	= 0b01000000
                 .equ	bit7	= 0b10000000
                 
                 
                 
                 ;------------------------------------------------;
                 ; Load immediate word into the resister pair.
                 ;
                 ;	ldiw	Z,var
                 
                 .macro	ldiw
                 	ldi	@0L,low(@1)
                 	ldi	@0H,high(@1)
                 .endm
                 
                 
                 .macro	pushw
                 	push	@0L
                 	push	@0H
                 .endm
                 
                 .macro	popw
                 	pop		@0H
                 	pop		@0L
                 .endm
                 
                 ;------------------------------------------------;
                 ; Load memory word into the resister pair.
                 ;
                 ;	ldsw	Z,mem
                 
                 .macro	ldsw
                 	lds	@0L,@1
                 	lds	@0H,@1+1
                 .endm
                 
                 .macro	lddw
                 	ldd	@0L,@1
                 	ldd	@0H,@1+1
                 .endm
                 
                 
                 ;------------------------------------------------;
                 ; Store resister pair into memory
                 ;
                 ;	stsw	mem,Z
                 
                 .macro	stsw
                 	sts	@0,@1L
                 	sts	@0+1,@1H
                 .endm
                 
                 .macro	stdw
                 	std	@0,@1L
                 	std	@0+1,@1H
                 .endm
                 
                 
                 ;------------------------------------------------;
                 ; Store immediate into the indirect memory
                 ;
                 ;	sti	Z,imm
                 ;	stdi	Z+d,imm
                 
                 .macro	sti
                 	ldi	r16,@1
                 	st	@0,r16
                 .endm
                 
                 .macro	stdi
                 	ldi	r16,@1
                 	std	@0,r16
                 .endm
                 
                 
                 ;------------------------------------------------;
                 ; Add/Subtract immediate to register
                 ;
                 ;	addi	var,imm
                 
                 .macro	addi
                 	subi	@0,-(@1)
                 .endm
                 
                 .macro	addiw
                 	subi	@0L,low(-(@1))
                 	sbci	@0H,high(-(@1))
                 .endm
                 
                 .macro	subiw
                 	subi	@0L,low(@1)
                 	sbci	@0H,high(@1)
                 .endm
                 
                 
                 ;------------------------------------------------;
                 ; Add/Subtract/Compare register pair
                 ;
                 
                 .macro	addw
                 	add	@0L,@1L
                 	adc	@0H,@1H
                 .endm
                 
                 .macro	subw
                 	sub	@0L,@1L
                 	sbc	@0H,@1H
                 .endm
                 
                 .macro	cpw
                 	cp	@0L,@1L
                 	cpc	@0H,@1H
                 .endm
                 
                 .macro	cpwi
                 	cpi		@0H, High(@1)
                 	brcs	PC+2
                 	cpi		@0L, Low(@1)
                 .endm
                 
                 ;------------------------------------------------;
                 ; Store immediate into the direct memory
                 ;
                 ;	stsi	var,imm
                 
                 .macro	stsi
                 	ldi	r16,@1
                 	sts	@0,r16
                 .endm
                 
                 .macro stswi
                 	stsi	@0	, Low(@1)
                 	stsi	@0+1, High(@1)	
                 .endm
                 
                 ;------------------------------------------------;
                 ; Input universal
                 ;
                 ;	uin	var, port
                 
                 .macro    uin
                   	.if	@1 < 0x40
                     	in	@0,@1         
                 	.else
                       	lds	@0,@1
                 .endif
                 .endm
                 
                 
                 ;------------------------------------------------;
                 ; Output universal
                 ;
                 ;	uout	port,var
                 
                 .macro    uout
                   	.if	@0 < 0x40
                     	OUT	@0,@1         
                 	.else
                       	STS	@0,@1
                 .endif
                 .endm
                 
                 ;------------------------------------------------;
                 ; Output immediate
                 ;
                 ;	outi	port,var
                 
                 .macro	outi
                 	ldi		r16,@1
                 	uout	@0,r16
                 .endm
                 
                 
                 ;------------------------------------------------;
                 ; Long branch
                 
                 
                 .macro	rjne
                 	breq	PC+2
                 	rjmp	@0
                 .endm
                 
                 .macro	rjeq
                 	brne	PC+2
                 	rjmp	@0
                 .endm
                 
                 .macro	rjcc
                 	brcs	PC+2
                 	rjmp	@0
                 .endm
                 
                 .macro	rjcs
                 	brcc	PC+2
                 	rjmp	@0
                 .endm
                 
                 .macro	retcc
                 	brcs	PC+2
                 	ret
                 .endm
                 
                 .macro	retcs
                 	brcc	PC+2
                 	ret
                 .endm
                 
                 .macro	reteq
                 	brne	PC+2
                 	ret
                 .endm
                 
                 .macro	retne
                 	breq	PC+2
                 	ret
                 .endm
                 
                 .macro	retts
                 	brtc	PC+2
                 	ret
                 .endm
                 
                 .macro	rettc
                 	brts	PC+2
                 	ret
                 
                 .EQU	l_green = PB0
                 .EQU	l_blue = PB1
                 .EQU	l_red = PB2
                 
                 //#define	F_CPU 8000000
                 #define	F_CPU 9600000
                 
                 ;----------------------------------------------------------;
                 ; Data memory area
                 
                 .dseg
                 .ORG	RAMTOP
                 
                 ;.EQU	MaxInputSize	=	32
                 ;LineBuf:.byte	MaxInputSize	;Command line characters buffer 
                 ;ByteBuf:.byte	MaxInputSize/2  ;Command line bytes buffer
                 
                 ;----------------------------------------------------------;
                 ; Program code area
                 
                 .CSEG
                 .ORG $0000
                 
000000 c009      rjmp RESET ; Address 0x0000
                 /*
                 ; Tiny 25/45/85 
                 RETI	;	rjmp INT0_ISR ; Address 0x0001
                 RETI	;	rjmp PCINT0_ISR ; Address 0x0002
                 RETI	;	rjmp TIM1_COMPA_ISR ; Address 0x0003
                 RETI	;	rjmp TIM1_OVF_ISR ; Address 0x0004
                 RETI	;	rjmp TIMER_ISR ;	rjmp TIM0_OVF_ISR ; Address 0x0005
                 RETI	;	rjmp EE_RDY_ISR ; Address 0x0006
                 RETI	;	rjmp ANA_COMP_ISR ; Address 0x0007
                 RETI	;	rjmp ADC_ISR ; Address 0x0008
                 RETI	;	rjmp TIM1_COMPB_ISR ; Address 0x0009
                 RETI	;	rjmp TIM0_COMPA_ISR ; Address 0x000A
                 RETI	;	rjmp TIM0_COMPB_ISR ; Address 0x000B
                 RETI	;	rjmp WDT_ISR ; Address 0x000C
                 RETI	;	rjmp USI_START_ISR ; Address 0x000D
                 RETI	;	rjmp USI_OVF_ISR ; Address 0x000E
                 */
                 ;Tiny13
000001 9518      RETI	;	rjmp EXT_INT0 ; IRQ0 Handler
000002 9518      RETI	;	rjmp PCINT0 ; PCINT0 Handler
000003 9518      RETI	;	rjmp TIM0_OVF ; Timer0 Overflow Handler
000004 9518      RETI	;	rjmp EE_RDY ; EEPROM Ready Handler
000005 9518      RETI	;	rjmp ANA_COMP ; Analog Comparator Handle
000006 9518      RETI	;	rjmp TIM0_COMPA ; Timer0 CompareA Handler
000007 9518      RETI	;	rjmp TIM0_COMPB ; Timer0 CompareB Handler
000008 9518      RETI	;	rjmp WATCHDOG ; Watchdog Interrupt Handl
000009 9518      RETI	;	rjmp ADC ; ADC Conversion Handler
                 
                 ;----------------------------------------------------------;
                 ; Initialize
                 
                 RESET:
00000a e90f
00000b bf0d      	outi	SPL,low(RAMEND)		;
                 ;	outi	SPH,high(RAMEND)	;
00000c e007
00000d bb07      	outi	DDRB, (1<<l_green)|(1<<l_blue)|(1<<l_red)
00000e ef0f
00000f bb08      	outi	PORTB, 0xff			; Pullup		
                 
000010 e090      	ldi		R25,0				; flashing flag
                 
                 ;----------------------------------------------------------;
                 ; Main loop
                 
                 main:
000011 d001      	rcall	ReadOneWire
000012 cffe      rjmp	main
                 
                 .MACRO OW_cmd
                 	ldi r16,@0 
                 	rcall	OWWriteByte
                 .ENDMACRO
                 
                 
                 ;----------------------------------------------------------;
                 ; Read temperature from _all_ connected devices, and read first result
                 ReadOneWire:
000013 d048      	rcall	OWReset
                 
                 // ËÌ‰ËÍ‡ˆËˇ Ì‡ÎË˜Ëˇ ÛÒÚÓÈÒÚ‚‡
                 //	in		r16, PINB
                 //	ori		r16, (1<<led)
                 //	bld		r16, led		; Á‡„ÛÁËÚ¸ ËÁ T ‚ led ·ËÚ (ÂÒÎË ·ËÚ ‡‚ÂÌ 0), ÚÓ ÛÒÚÓÈÒÚ‚Ó Ì‡ i2c ÂÒÚ¸ Ë Á‡ÊË„‡ÂÏ ‰ËÓ‰
                 //	out		PORTB, r16
                 
000014 ec0c
000015 d063      	OW_cmd	0xCC			; ‡‰ÂÒÛÂÏÒˇ ÍÓ ‚ÒÂÏÛ
000016 e404
000017 d061      	OW_cmd	0x44			; dallas - measure
                 
000018 ec08      	ldi		r16, 200
000019 d037      	rcall	WaitMiliseconds
                 
00001a d041      	rcall	OWReset
                 
                 //	OW_cmd	0x55			; ‡‰ÂÒÛÂÏÒˇ Í ÍÓÌÍÂÚÌÓÏÛ
                 //	rcall	OWSendROM_NO	; ‡‰ÂÒ ÍÓÌÍÂÚÌÓ„Ó
00001b ec0c
00001c d05c      	OW_cmd	0xCC			; ‡‰ÂÒÛÂÏÒˇ ÍÓ ‚ÒÂÏÛ
                 
00001d eb0e
00001e d05a          OW_cmd	0xBE			; ˜ËÚ‡ÂÏ Ô‡ÏˇÚ¸
                 
                 read_temp_onewire:			; ˜ËÚ‡ÂÏ Ë ÔÂÓ·‡ÁÛÂÏ ÚÂÏÔÂ‡ÚÛÛ
00001f d074      	rcall	OWReadByte		; ÏÎ‡‰¯ËÈ ·‡ÈÚ HI - ÏÎ‡‰¯ËÂ ‡Áˇ‰˚ ˆÂÎ˚ı, LO - ‰ÂÒˇÚ˚Â
000020 2f10      	mov		r17, r16		
000021 d072      	rcall	OWReadByte		; ÒÚ‡¯ËÈ ·‡ÈÚ LO - ÒÚ‡¯ËÂ ‡Áˇ‰˚ ˆÂÎ˚ı
000022 3008      	cpi		r16, 0x08			; ÔÓ‚ÂˇÏ Ì‡ ÓÚËˆ‡ÚÂÎ¸ÌÓÒÚ¸
000023 f008      	brlo	temp_up_zerro	; ‚˚¯Â ÌÛÎˇ - ÛıÓ‰ËÏ
                 //; ÚÛÚ Ì‡‰Ó Ò‰ÂÎ‡Ú¸ ÔÂÓ·‡ÁÓ‚‡ÌËÂ ËÁ ‰ÓÔÓÎÌÂÌÌÓ„Ó ÍÓ‰‡, ÌÓ ÔÓÍ‡ ÛÔÓÒÚËÏ
000024 7007      	andi	r16, 0x07		; ÔÓÒÚÓ ÓÚÒÂ˜ÂÏ ·ËÚ˚ ÁÌ‡Í‡ (˜ÚÓ ÌÂ Ô‡‚ËÎ¸ÌÓ) Ë ‚ÓÁ¸ÏÂÏ ˆÂÎÛ˛ ˜‡ÒÚ¸
                 
                 temp_up_zerro:
000025 7f10      	andi	r17, 0xf0		; HI(R17) = ÏÎ‡‰¯ËÂ ÁÌ‡ÍË ÚÂÏÔÂ‡ÚÛ˚
000026 2b10      	or		r17, r16		; HI(R17)- ÏÎ‡‰¯ËÂ, LO(R17) - ÒÚ‡¯ËÂ
000027 9512      	swap	r17				; ÚÂÔÂ¸ ‚ÒÂ Ì‡ Ò‚ÓËı ÏÂÒÚ‡ı
                 
000028 9ac1      	sbi		PORTB, l_blue	; turn off blue
000029 9ac0      	sbi		PORTB, l_green	; turn off green
00002a 9ac2      	sbi		PORTB, l_red	; turn off red
                 
00002b c01c      rjmp less35
00002c 3217      	cpi		r17, 39			; >39 ultra high, flash red
00002d f030      	brlo	less39
                 
00002e 9590      	com		r25				; flip flash status
00002f f411      	brne	flash1
000030 98c2      	cbi		PORTB, l_red		
000031 9508      	ret
                 flash1:
000032 9ac2      	sbi		PORTB, l_red
000033 9508      	ret
                 less39:						; 38-39 high
000034 3216      	cpi		r17, 38
000035 f010      	brlo	less38
000036 98c2      	cbi		PORTB, l_red	
000037 9508      	ret
                 less38:						; 37-38 raised
000038 3215      	cpi		r17, 37
000039 f030      	brlo	less37	
00003a 9590      	com		r25				; flip flash status
00003b f411      	brne	flash2
00003c 98c2      	cbi		PORTB, l_red
00003d 9508      	ret
                 flash2:	
00003e 98c0      	cbi		PORTB, l_green	
00003f 9508      	ret
                 less37:						; 36-37 normal
000040 3214      	cpi		r17, 36
000041 f010      	brlo	less36	
000042 98c0      	cbi		PORTB, l_green		
000043 9508      	ret
                 less36:						; 35-36 low
000044 3213      	cpi		r17, 35
000045 f010      	brlo	less35	
000046 98c1      	cbi		PORTB, l_blue		
000047 9508      	ret
                 less35:						; <35 very low
000048 9590      	com		r25				; flip flash status
000049 f411      	brne	flash3
00004a 98c1      	cbi		PORTB, l_blue
00004b 9508      	ret
                 flash3:	
00004c 9ac1      	sbi		PORTB, l_blue	
00004d 9508      	ret
                 
                 .include "1-wire.asm"
                 
                 ; http://avr-mcu.dxp.pl
                 ; (c) Radoslaw Kwiecien, 2008
                 ; 
                 ; –ü–µ—Ä–µ–≤–æ–¥ StarXXX, http://hardisoft.ru, 2009
                 ;------------------------------------------------------------------------------
                 
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –ù–∞—á–∞–ª—å–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ 1-Wire
                 ;------------------------------------------------------------------------------
                 .equ	OW_PORT	= PORTB				; –ü–æ—Ä—Ç –ú–ö, –≥–¥–µ –≤–∏—Å–∏—Ç 1-Wire
                 .equ	OW_PIN	= PINB				; –ü–æ—Ä—Ç –ú–ö, –≥–¥–µ –≤–∏—Å–∏—Ç 1-Wire
                 .equ	OW_DDR	= DDRB				; –ü–æ—Ä—Ç –ú–ö, –≥–¥–µ –≤–∏—Å–∏—Ç 1-Wire
                 .equ	OW_DQ	= PB4				; –ù–æ–∂–∫–∞ –ø–æ—Ä—Ç–∞, –≥–¥–µ –≤–∏—Å–∏—Ç 1-Wire
                 
                 .def	OWCount = r17				; –°—á–µ—Ç—á–∏–∫
                 ;------------------------------------------------------------------------------
                 
                 
                 .cseg
                 
                 .include 	"wait.asm"			; –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–æ–¥—É–ª—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫
                 
                 ; Busy-wait loops utilities module
                 ; For F_CPU >= 4MHz
                 ; http://avr-mcu.dxp.pl
                 ; (c) Radoslaw Kwiecien, 2008
                 ; 
                 ; –ü–µ—Ä–µ–≤–æ–¥ StarXXX, http://hardisoft.ru, 2009
                 ;------------------------------------------------------------------------------
                 
                 ;------------------------------------------------------------------------------
                 ; –ú–æ–¥—É–ª—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫
                 ;
                 ; !!! –î–ª—è —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—ä—è–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É F_CPU —Ä–∞–≤–Ω—É—é —Ç–∞–∫—Ç–æ–≤–æ–π —á–∞—Å—Ç–æ—Ç–µ –≤ –≥–µ—Ä—Ü–∞—Ö !!!
                 ;
                 ; !!! –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –¥–ª—è —Ç–∞–∫—Ç–æ–≤–æ–π —á–∞—Å—Ç–æ—Ç—ã >= 4 –ú–ì—Ü !!!
                 
                 
                 ; –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã! –ß–µ–º –±–æ–ª—å—à–µ –∑–∞–¥–µ—Ä–∂–∫–∞, —Ç–µ–º —Ç–æ—á–Ω–µ–µ,
                 ; —Ç.–µ. –ø—Ä–∏ —á–∞—Å—Ç–æ—Ç–µ 4–ú–ì—Ü –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ 1 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—É, —É—á–∏—Ç—ã–≤–∞—è –≤—Ä–µ–º—è –≤—ã–∑–æ–≤–∞ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ –Ω–µ–µ —Å–æ—Å—Ç–∞–≤–∏—Ç 2,5 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—ã
                 ; –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ 10 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥ —Å–æ—Å—Ç–∞–≤–∏—Ç 11,5 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥
                 ; –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ 100 –º–∫—Å –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –±—É–¥–µ—Ç 101,5 –º–∫—Å
                 ; —Ç–æ–µ—Å—Ç—å, –∫ –∫–∞–∂–¥–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ –¥–æ–±–∞–≤–∏—Ç—Å—è 1,5 –º–∫—Å - —ç—Ç–æ –≤—Ä–µ–º—è –Ω–∞ –≤—ã–∑–æ–≤ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –Ω–∞ –≤—ã—Ö–æ–¥ –∏–∑ –Ω–µ–µ
                 ;------------------------------------------------------------------------------
                 
                 
                 
                 #ifndef F_CPU
                 #endif
                 
                 #if F_CPU < 4000000
                 #endif
                 
                 
                 #define CYCLES_PER_US (F_CPU/1000000)	; –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–æ—Ç–≤ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—É
                 #define C4PUS (CYCLES_PER_US/4)		; 4 —Ç–∞–∫—Ç–∞ –Ω–∞ –æ–¥–Ω—É –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—É
                 #define DVUS(x) (C4PUS*x)		; –≤—ã—á–∏—Å–ª—è–µ—Ç –≤–µ–ª–∏—á–∏–Ω—É –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å Wait4xCycles —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∂–µ–ª–∞–µ–º—É—é –∑–∞–¥–µ—Ä–∂–∫—                 É
                 
                 ;--------------------------------------------------------------------------------------------------------------
                 ; –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–¥–µ—Ä–∂–∫–∏. –í —Ü–∏–∫–ª–µ –æ—Ç—ä–µ–¥–∞–µ—Ç—Å—è 4 —Ç–∞–∫—Ç–∞ –Ω–∞ –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é, –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π. –í –ø–æ—Å–ª–µ–¥–Ω–µ–π - 3 —Ç–∞–∫—Ç–∞.
                 ; –ò—Ç–æ–≥–æ, –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö –Ω–∞–¥–æ –≤—ã–∑—ã–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ
                 ; –æ–±—Ä–∞–±–æ—Ç–∞–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä –º–∞–∫—Ä–æ—Å–æ–º DVUS:
                 ;	ldi    XH, HIGH(DVUS(500))
                 ; 	ldi    XL, LOW(DVUS(500))
                 ; 	rcall  Wait4xCycles ; –ø–∞—É–∑–∞ 500 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥
                 ;--------------------------------------------------------------------------------------------------------------
                 ; Input : XH:XL - number of CPU cycles to wait (divided by four)
                 ;--------------------------------------------------------------------------------------------------------------
00004e 9711      Wait4xCycles:
00004f f7f1      	sbiw	XH:XL, 1			; 2 —Ç–∞–∫—Ç–∞
000050 9508      	brne	Wait4xCycles		; 1/2
                 	ret							; 4
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∑–∞–¥–µ—Ä–∂–∫—É –≤ –º–∏–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
                 ; –ù–∞ –≤—Ö–æ–¥–µ: r16 = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–ª–∏—Å–µ–∫—É–Ω–¥
                 ;------------------------------------------------------------------------------
                 ; Input : r16 - number of miliseconds to wait
                 ;------------------------------------------------------------------------------
000051 930f      WaitMiliseconds:
                 	push 	r16
000052 e0b3      WaitMsLoop: 
000053 eea8      	ldi    XH,HIGH(DVUS(500))
000054 dff9      	ldi    XL,LOW(DVUS(500))
000055 e0b3      	rcall  Wait4xCycles
000056 eea8      	ldi    XH,HIGH(DVUS(500))
000057 dff6      	ldi    XL,LOW(DVUS(500))
000058 950a      	rcall  Wait4xCycles
000059 f7c1      	dec    r16
00005a 910f      	brne   WaitMsLoop
00005b 9508      	pop    r16
                 	ret
                 ;------------------------------------------------------------------------------
                 ; End of file
                 
                 ;------------------------------------------------------------------------------
                 ; –°–ë–†–û–°
                 ; –ö–∞–∂–¥–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É 1-Wire –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Å–∏–≥–Ω–∞–ª–∞ Reset.
                 ; –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —ç—Ç–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤ —Ñ–ª–∞–≥–µ –¢ —Ä–µ–≥–∏—Å—Ç—Ä–∞ SGER —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –±–∏—Ç 
                 ; –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è: 1 - –µ—Å–ª–∏ –Ω–∞ —à–∏–Ω–µ –Ω–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤, 0 - –µ—Å–ª–∏ –µ—Å—Ç—å
                 ;------------------------------------------------------------------------------
                 ; Output : T - presence bit
                 ;------------------------------------------------------------------------------
                 OWReset:
00005c 98c4      	cbi		OW_PORT,OW_DQ		; –í—ã–≤–æ–¥–∏–º –≤ –ø–æ—Ä—Ç 0
00005d 9abc      	sbi		OW_DDR,OW_DQ		; –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –ø–æ—Ä—Ç –Ω–∞ –≤—ã–≤–æ–¥
                 
00005e e0b3      	ldi		XH, HIGH(DVUS(470))	; –ñ–¥–µ–º 470 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥ –ø—Ä–∏ –ø—Ä–∏–¥–∞–≤–ª–µ–Ω–Ω–æ–π –≤ 0 –ª–∏–Ω–∏–∏. –≠—Ç–æ –∏ –µ—Å—Ç—å –∏–º–ø—É–ª—å—Å —Å–±—Ä–æ—Å–∞.
00005f eaac      	ldi		XL, LOW(DVUS(470))
000060 dfed      	rcall		Wait4xCycles
                 	
000061 98bc      	cbi		OW_DDR,OW_DQ		; –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –ø–æ—Ä—Ç –Ω–∞ –≤–≤–æ–¥
                 
000062 e0b0      	ldi		XH, HIGH(DVUS(70))	; –≤—ã–∂–∏–¥–∞–µ–º 70 –º–∫—Å (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —Å–±—Ä–æ—Å)
000063 e8ac      	ldi		XL, LOW(DVUS(70))
000064 dfe9      	rcall		Wait4xCycles
                 
000065 9468      	set							; –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –¢ –≤ 1
000066 9bb4      	sbis	OW_PIN,OW_DQ		; –ï—Å–ª–∏ –Ω–∞ –ª–∏–Ω–∏–∏ –ø–æ—Å–ª–µ –ø–∞—É–∑—ã –æ—Å—Ç–∞–ª–∞—Å—å 1, –∑–Ω–∞—á–∏—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ 1-Wire –Ω–∞ –Ω–µ–π –Ω–µ—Ç. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥. –∫–æ–º–∞–Ω–¥—É
000067 94e8      	clt							; –õ–∏–Ω–∏—è –±—ã–ª–∞ –≤ 0 - –∑–Ω–∞—á–∏—Ç –Ω–∞ –Ω–µ–π –∫—Ç–æ-—Ç–æ –µ—Å—Ç—å, –∏ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞–º –∏–º–ø—É–ª—å—Å–æ–º PRESENCE
                 
000068 e0b1      	ldi		XH, HIGH(DVUS(240))	; –ü–∞—É–∑–∞ 240 –º–∫—Å –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞
000069 eea0      	ldi		XL, LOW(DVUS(240))
00006a dfe3      	rcall		Wait4xCycles
                 
00006b 9508      	ret
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –û–¢–ü–†–ê–í–ö–ê 1 –ë–ò–¢–ê
                 ; –≠—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 1 –±–∏—Ç –≤ –ª–∏–Ω–∏—é 1-Wire.
                 ; –û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–π –±–∏—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–º–µ—â–µ–Ω –≤ —Ñ–ª–∞–≥ –° —Å—Ç–∞—Ç—É—Å–Ω–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
                 ;------------------------------------------------------------------------------
                 ; Input : C - bit to write
                 ;------------------------------------------------------------------------------
                 OWWriteBit:
00006c f418      	brcc	OWWriteZero			; –ï—Å–ª–∏ —Ñ–ª–∞–≥ –° = 0, —Ç–æ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ OWWriteZero
00006d e0b0      	ldi		XH, HIGH(DVUS(1))	; –î–ª—è –ø–æ—Å—ã–ª–∫–∏ 1 –ª–∏–Ω–∏—é –Ω—É–∂–Ω–æ –ø—Ä–∏–¥–∞–≤–∏—Ç—å –≤ 0 –≤—Å–µ–≥–æ –Ω–∞ 1 –º–∫—Å
00006e e0a2      	ldi		XL, LOW(DVUS(1))
00006f c002      	rjmp	OWWriteOne			; –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ
                 OWWriteZero:	
000070 e0b0      	ldi		XH, HIGH(DVUS(120))	; –î–ª—è –ø–æ—Å—ã–ª–∫–∏ 0 –ª–∏–Ω–∏—é –Ω—É–∂–Ω–æ –ø—Ä–∏–¥–∞–≤–∏—Ç—å –≤ 0 –Ω–∞ 120 –º–∫—Å
000071 efa0      	ldi		XL, LOW(DVUS(120))
                 OWWriteOne:
000072 9abc      	sbi		OW_DDR, OW_DQ		; –ü–µ—Ä–µ–≤–æ–¥–∏–º –ø–æ—Ä—Ç –Ω–∞ –≤—ã—Ö–æ–¥, –∞ —Ç–∞–º —É–∂–µ –±—ã–ª 0, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ –ª–∏–Ω–∏—è –ø—Ä–∏–¥–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0
000073 dfda      	rcall	Wait4xCycles		; –∂–¥–µ–º
000074 98bc      	cbi		OW_DDR, OW_DQ		; –ü–µ—Ä–µ–≤–æ–¥–∏–º –ø–æ—Ä—Ç –Ω–∞ –≤—Ö–æ–¥
                 	
000075 e0b0      	ldi		XH, HIGH(DVUS(60))	; –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–∞—É–∑–∞ –º–µ–∂–¥—É —Ç–∞–π–º—Å–ª–æ—Ç–∞–º–∏, –≤–æ–æ–±—â–µ-—Ç–æ –æ—Ç 1 –º–∫—Å, –Ω–æ –∑–¥–µ—Å—å —Å–¥–µ–ª–∞–ª–∏ 60 –º–∫—Å
000076 e7a8      	ldi		XL, LOW(DVUS(60))
000077 dfd6      	rcall	Wait4xCycles
000078 9508      	ret
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –û–¢–ü–†–ê–í–ö–ê 1 –ë–ê–ô–¢–ê
                 ; –≠—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 1 –±–∞–π—Ç –≤ –ª–∏–Ω–∏—é 1-Wire.
                 ; –û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–π –±–∞–π—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–º–µ—â–µ–Ω –≤ —Ä–µ–≥–∏—Å—Ç—Ä r16
                 ;------------------------------------------------------------------------------
                 ; Input : r16 - byte to write
                 ;X,r16 - broken!
                 ;------------------------------------------------------------------------------
                 OWWriteByte:
000079 931f      	push	OWCount			; –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä —Å—á–µ—Ç—á–∏–∫–∞
00007a e010      	ldi		OWCount,0		; –í–∑–≤–æ–¥–∏–º –≤ –Ω—ë–º –Ω–æ–ª–∏–∫
                 
                 OWWriteLoop:				
00007b 9507      	ror		r16				; –°–¥–≤–∏–≥–∞–µ–º –±–∞–π—Ç –≤–ø—Ä–∞–≤–æ —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ C
00007c dfef      	rcall	OWWriteBit		; –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –ª–∏–Ω–∏—é
00007d 9513      	inc		OWCount			; —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
00007e 3018      	cpi		OWCount,8		; –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ 8
00007f f7d9      	brne	OWWriteLoop		; –µ—Å–ª–∏ –º–µ–Ω—å—à–µ - —Å–ª–µ–¥—É—é—â–∏–π –±–∏—Ç
000080 911f      	pop		OWCount			; –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä-—Å—á–µ—Ç—á–∏–∫
000081 9508      	ret
                 
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –ß–¢–ï–ù–ò–ï 1 –ë–ò–¢–ê
                 ; –≠—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —á–∏—Ç–∞–µ—Ç 1 –±–∏—Ç –∏–∑ –ª–∏–Ω–∏–∏ 1-Wire.
                 ; –ü—Ä–∏–Ω—è—Ç—ã–π –±–∏—Ç –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ñ–ª–∞–≥ –° —Å—Ç–∞—Ç—É—Å–Ω–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
                 ;------------------------------------------------------------------------------
                 ; Output : C - bit from slave
                 ;------------------------------------------------------------------------------
                 OWReadBit:
000082 e0b0      	ldi		XH, HIGH(DVUS(1))	; –ü—Ä–∏–¥–∞–≤–ª–∏–≤–∞–µ–º –ª–∏–Ω–∏—é –≤ 0 –Ω–∞ 1 –º–∫—Å
000083 e0a2      	ldi		XL, LOW(DVUS(1))
000084 9abc      	sbi		OW_DDR, OW_DQ
000085 dfc8      	rcall	Wait4xCycles
                 
000086 98bc      	cbi		OW_DDR, OW_DQ		; –ü–µ—Ä–µ–≤–æ–¥–∏–º –ø–æ—Ä—Ç –Ω–∞ —á—Ç–µ–Ω–∏–µ
000087 e0b0      	ldi		XH, HIGH(DVUS(5))	; –∂–¥–µ–º 5 –º–∫—Å
000088 e0aa      	ldi		XL, LOW(DVUS(5))
000089 dfc4      	rcall	Wait4xCycles
                 
00008a 94e8      	clt							; –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –¢
00008b 99b4      	sbic	OW_PIN,OW_DQ		; –ï—Å–ª–∏ –Ω–∞ –ª–∏–Ω–∏–∏ 0 - —Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É
00008c 9468      	set
                 
                 								; –ò—Ç–∞–∫, —Å–µ–π—á–∞—Å –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ –¢ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –±–∏—Ç
                 
00008d e0b0      	ldi		XH, HIGH(DVUS(50))	; –≤—ã–∂–∏–¥–∞–µ–º 50 –º–∫—Å –¥–ª—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–∞–π–º—Å–ª–æ—Ç–∞
00008e e6a4      	ldi		XL, LOW(DVUS(50))
00008f dfbe      	rcall	Wait4xCycles
                 								; –ø–µ—Ä–µ–Ω–æ—Å–∏–º —Ñ–ª–∞–≥ –¢ –≤ —Ñ–ª–∞–≥ –°
000090 9408      	sec
000091 f00e      	brts	OWReadBitEnd
000092 9488      	clc
                 
                 OWReadBitEnd:
000093 9508      	ret
                 
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –ß–¢–ï–ù–ò–ï 1 –ë–ê–ô–¢–ê
                 ; –≠—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —á–∏—Ç–∞–µ—Ç 1 –±–∞–π—Ç –∏–∑ –ª–∏–Ω–∏–∏ 1-Wire.
                 ; –ü—Ä–∏–Ω—è—Ç—ã–π –±–∞–π—Ç –ø–æ–º–µ—â–∞–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä r16
                 ;------------------------------------------------------------------------------
                 ; Output : r16 - byte from slave
                 ;------------------------------------------------------------------------------
                 OWReadByte:
000094 931f      	push	OWCount			; –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä-—Å—á–µ—Ç—á–∏–∫
000095 e010      	ldi		OWCount,0		; –∏ –æ–±–Ω—É–ª—è–µ–º –µ–≥–æ
                 OWReadLoop:
000096 dfeb      	rcall	OWReadBit		; —á–∏—Ç–∞–µ–º –±–∏—Ç
000097 9507      	ror		r16				; –∑–∞–ø–∏—Ö–∏–≤–∞–µ–º –µ–≥–æ –≤ r16 —Å–¥–≤–∏–≥–æ–º –≤–ø—Ä–∞–≤–æ –∏–∑ —Ñ–ª–∞–≥–∞ –°
000098 9513      	inc		OWCount			; —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
000099 3018      	cpi		OWCount,8		; —É–∂–µ 8?
00009a f7d9      	brne	OWReadLoop		; –Ω–µ—Ç - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å—á–∏—Ç—ã–≤–∞—Ç—å
00009b 911f      	pop		OWCount			; –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä-—Å—á–µ—Ç—á–∏–∫
00009c 9508      	ret
                 ;------------------------------------------------------------------------------
                 ;
                 ;------------------------------------------------------------------------------
                 
                 
                 .include 	"1-Wire Search.asm"		; –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–æ–¥—É–ª—å –ø–æ–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —à–∏–Ω–µ 1-Wire
                 
                 ; –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —à–∏–Ω–µ 1-Wire
                 ; –û—Ä–∏–≥–∏–Ω–∞–ª: Application Note 187. 1-Wire Search Algorithm by Dallas, –° code
                 ; –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä: StarXXX, http://hardisoft.ru (c) 2009
                 ;***********************************************************************************
                 ; –ü–æ—Ä—è–¥–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
                 ;	1) –û—á–∏—Å—Ç–∏—Ç—å ROM_NO –≤—ã–∑–æ–≤–æ–º –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã OWClearROM_NO
                 ;	2) –ü—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã–π –ø–æ–∏—Å–∫ –≤—ã–∑–æ–≤–æ–º –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã OWFirst
                 ;	3) –µ—Å–ª–∏ —Ñ–ª–∞–≥ search_result –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ search_flags = 1 —Ç–æ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å 
                 ;		–Ω–∞–π–¥–µ–Ω–Ω—ã–π –∫–æ–¥ –ü–ó–£ –∏–∑ ROM_NO, –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–∏—Å–∫ –≤—ã–∑–æ–≤–æ–º 
                 ;		–ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã OWNext –∏ –ø–µ—Ä–µ–π—Ç–∏ –∫ –ø—É–Ω–∫—Ç—É 3
                 ;
                 ; –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã: r16, r17, r20 (search_flags)
                 ;
                 ; 
                 ; –ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã:
                 ;
                 ;	OWReset - –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–±—Ä–æ—Å –ª–∏–Ω–∏–∏ 1-Wire, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏–º–ø—É–ª—å—Å
                 ;			–ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è PRESENCE. –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —ç—Ç–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤ —Ñ–ª–∞–≥–µ –¢ —Ä–µ–≥–∏—Å—Ç—Ä–∞ 
                 ;			SREG —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –±–∏—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è: 1 - –µ—Å–ª–∏ –Ω–∞ —à–∏–Ω–µ –Ω–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤, 
                 ;			0 - –µ—Å–ª–∏ –µ—Å—Ç—å
                 ;
                 ;	OWWriteByte - –≠—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 1 –±–∞–π—Ç –≤ –ª–∏–Ω–∏—é 1-Wire. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–π 
                 ;			–±–∞–π—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–º–µ—â–µ–Ω –≤ —Ä–µ–≥–∏—Å—Ç—Ä r16
                 ;	
                 ;	OWReadBit - –≠—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —á–∏—Ç–∞–µ—Ç 1 –±–∏—Ç –∏–∑ –ª–∏–Ω–∏–∏ 1-Wire. –ü—Ä–∏–Ω—è—Ç—ã–π –±–∏—Ç 
                 ;			–ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ñ–ª–∞–≥ –° —Ä–µ–≥–∏—Å—Ç—Ä–∞ SREG
                 ;
                 ;	OWWriteBit - –≠—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 1 –±–∏—Ç –≤ –ª–∏–Ω–∏—é 1-Wire. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–π 
                 ;			–±–∏—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–º–µ—â–µ–Ω –≤ —Ñ–ª–∞–≥ –° —Ä–µ–≥–∏—Å—Ç—Ä–∞ SREG
                 ;
                 ;***********************************************************************************
                 
                 
                 ; –§–ª–∞–≥–∏
                 .equ		search_result		= 0
                 .equ		search_direction 	= 1
                 .equ		LastDeviceFlag		= 2
                 
                 ; –†–µ–≥–∏—Å—Ç—Ä—ã
                 .def		search_flags		= r20
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –ü–æ–∏—Å–∫ –ø–µ—Ä–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ —à–∏–Ω–µ
                 ;------------------------------------------------------------------------------
                 OWFirst:
                     ; –æ–±–Ω—É–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
00009d 2700      	clr		r16
00009e 9300 0065 	sts		LastDiscrepancy, r16
0000a0 9300 0066 	sts		LastFamilyDiscrepancy, r16
0000a2 9300 0060 	sts		stored_search_flags, r16
                 
0000a4 d001         	rcall 	OWNext
0000a5 9508      	ret
                 
                 
                 ;------------------------------------------------------------------------------
                 ; –ü–æ–∏—Å–∫ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ —à–∏–Ω–µ
                 ;------------------------------------------------------------------------------
                 OWNext:
0000a6 9140 0060 	lds		search_flags, stored_search_flags	; –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–æ–∏—Å–∫–∞
                 
0000a8 2700         	clr 	r16
0000a9 9300 0064    	sts 	last_zero, r16						; last_zero = 0
0000ab 9300 0062    	sts 	rom_byte_number, r16				; rom_byte_number = 0
0000ad 9300 0067    	sts 	crc8, r16							; crc8 = 0
                 
0000af 9503         	inc 	r16
0000b0 9300 0061    	sts 	id_bit_number, r16					; id_bit_number = 1
0000b2 9300 0063    	sts 	rom_byte_mask, r16					; rom_byte_mask = 1
                 
0000b4 7f4e      	cbr		search_flags, 1<<search_result		; search_result = FALSE
                 
0000b5 fd42      	sbrc	search_flags, LastDeviceFlag		; –≠—Ç–æ –±—ã–ª–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ?
0000b6 c086      	rjmp 	OWSItWasLastDevice					; –î–∞ - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ OWSItWasLastDevice
                 
                 
                 OWS_Reset:										; –°–±—Ä–æ—Å –ª–∏–Ω–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
0000b7 dfa4      	rcall 	OWReset
0000b8 f446      	brtc 	OWSResetOK
                 												; –ù–∏–∫–æ–≥–æ –Ω–µ—Ç? –¢–æ–≥–¥–∞ –≤—ã—Ö–æ–¥–∏–º
0000b9 2700      	clr 	r16
0000ba 9300 0065 	sts 	LastDiscrepancy, r16				; LastDiscrepancy = 0;
0000bc 9300 0066 	sts 	LastFamilyDiscrepancy, r16			; LastFamilyDiscrepancy = 0;
0000be 7f4b      	cbr		search_flags, 1<<LastDeviceFlag		; LastDeviceFlag = FALSE;
0000bf 7f4e      	cbr		search_flags, 1<<search_result		; return FALSE;
                 
0000c0 c089      	rjmp	OWN_Return
                 
                 
                 OWSResetOK:
0000c1 ef00      	ldi 	r16, 0xF0							; –ü–æ—Å—ã–ª–∞–µ–º –∫–æ–º–∞–Ω–¥—É –ø–æ–∏—Å–∫–∞ (0F)
0000c2 94f8      	cli
0000c3 dfb5      	rcall 	OWWriteByte
0000c4 9478      	sei
                 
                 
                 OWS_do:											; –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –ø–æ–∏—Å–∫–∞
0000c5 2700      	clr 	r16
0000c6 2711      	clr 	r17
0000c7 6042      	sbr		search_flags, 1<<search_direction	; –°—Ä–∞–∑—É –ø–æ—Å—Ç–∞–≤–∏–º search_direction=1, –ø–æ—Ç–æ–º –µ—Å–ª–∏ —á—Ç–æ - —Å–±—Ä–æ—Å–∏–º
                 	
0000c8 94f8      	cli
0000c9 dfb8      	rcall 	OWReadBit							; —á–∏—Ç–∞–µ–º id_bit -> C
0000ca 1f00      	rol 	r16									; –∏–∑ —Ñ–ª–∞–≥–∞ C –≤ –Ω—É–ª–µ–≤–æ–π –±–∏—Ç r16
                 
0000cb dfb6      	rcall 	OWReadBit							; —á–∏—Ç–∞–µ–º cmp_id_bit -> C
0000cc 1f11      	rol 	r17									; –∏–∑ —Ñ–ª–∞–≥–∞ C –≤ –Ω—É–ª–µ–≤–æ–π –±–∏—Ç r17
0000cd 9478      	sei
                 
0000ce 2300      	tst 	r16
0000cf f019      	breq 	OWS_do_1_0
                 
0000d0 2311      	tst 	r17
0000d1 f011      	breq 	OWS_do_1_1
0000d2 c04e      	rjmp 	OWS_do_break						; id_bit = 1 –∏ cmp_id_bit = 1 - –Ω–∞ –ª–∏–Ω–∏–∏ –Ω–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤!
                 
                 
                 OWS_do_1_0:
0000d3 7f4d      	cbr		search_flags, 1<<search_direction	; search_direction –ø–æ–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç id_bit
                 
                 
                 OWS_do_1_1:										;  –µ—Å–ª–∏ id_bit –Ω–µ —Ä–∞–≤–µ–Ω cmp_id_bit, —Ç–æ–≥–¥–∞ search_direction = id_bit
0000d4 1701      	cp 		r16, r17
0000d5 f4d9      	brne 	OWS_do_2
                 
                 	; –ò–Ω–∞—á–µ - –±–∏—Ç—ã —Ä–∞–≤–Ω—ã, —Ç–æ–≥–¥–∞ search_direction –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç id_bit_number –∏ LastDiscrepancy
                 	
0000d6 6042      	sbr		search_flags, 1<<search_direction	; —É—Å—Ç–∞–Ω–æ–≤–∏–º –ø–æ–∫–∞ search_direction = 1
                 
0000d7 9100 0061 	lds 	r16, id_bit_number					; –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ id_bit_number –∏ LastDiscrepancy
0000d9 9110 0065 	lds		r17, LastDiscrepancy
                 
0000db 1701      	cp 		r16, r17							; —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º
0000dc f051      	breq	BitsEqual_End						; id_bit_number = LastDiscrepancy, –∑–Ω–∞—á–∏—Ç –æ—Å—Ç–∞–≤–ª—è–µ–º search_direction = 1
0000dd f440      	brcc	OWS_do_BitsEqual_else				; id_bit_number > LastDiscrepancy, –∑–Ω–∞—á–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–∏–º search_direction = 0
                 
                 	; –∏–Ω–∞—á–µ id_bit_number < LastDiscrepancy, –∞ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ search_direction –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω
                 	; –∑–Ω–∞—á–µ–Ω–∏—é —Ç–µ–∫—É—â–µ–≥–æ –±–∏—Ç–∞ –≤ ROM_NO
                 				
0000de d06e      	rcall	Calc_ROM_NO							; –ü–æ–ª—É—á–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ROM_NO[rom_byte_number]
0000df 8108      	ld		r16, y								; –ü–æ–ª—É—á–∏–ª–∏ –≤ r16 ROM_NO[rom_byte_number]
0000e0 9110 0063 	lds		r17, rom_byte_mask					; –î–µ–ª–∞–µ–º ROM_NO[rom_byte_number] AND rom_byte_mask
0000e2 2301      	and		r16, r17
                 
0000e3 f419      	brne	BitsEqual_End						; –µ—Å–ª–∏ –ø–æ—Å–ª–µ AND —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –Ω—É–ª–µ–≤–æ–π, —Ç–æ –æ—Å—Ç–∞–≤–∏–º search_direction = 1
0000e4 7f4d      	cbr		search_flags, 1<<search_direction	; –∏–Ω–∞—á–µ –ø–µ—Ä–µ–∫–ª—é—á–∏–º search_direction –≤ 0
0000e5 c001      	rjmp 	BitsEqual_End
                 
                 
                 OWS_do_BitsEqual_else:							; id_bit_number = LastDiscrepancy, –∑–Ω–∞—á–∏—Ç –æ—Å—Ç–∞–≤–ª—è–µ–º search_direction = 1
0000e6 7f4d      	cbr		search_flags, 1<<search_direction
                 
                 
                 BitsEqual_End:
0000e7 fd41      	sbrc	search_flags, search_direction		; –µ—Å–ª–∏ search_direction = 0,
0000e8 c008      	rjmp 	OWS_do_2
                 
0000e9 9100 0061 	lds 	r16, id_bit_number					; —Ç–æ–≥–¥–∞ last_zero = id_bit_number
0000eb 9300 0064 	sts 	last_zero, r16
                 
                 	; –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–∞–∑–ª–∏—á–∏—è –≤ –∫–æ–¥–µ —Å–µ–º–µ–π—Å—Ç–≤–∞.
0000ed 3009      	cpi 	r16, 9								; –ï—Å–ª–∏ last_zero < 9
0000ee f410      	brcc 	OWS_do_2
                 
0000ef 9300 0066 	sts 	LastFamilyDiscrepancy, r16  		; —Ç–æ–≥–¥–∞ LastFamilyDiscrepancy = last_zero;
                 
                 
                 OWS_do_2:
0000f1 d05b      	rcall	Calc_ROM_NO							; –ü–æ–ª—É—á–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ROM_NO[rom_byte_number]
                 
                 	; –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–ª–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –±–∏—Ç –≤ –ø–æ–∑–∏—Ü–∏–∏ rom_byte_mask –±–∞–π—Ç–∞ rom_byte_number
                 	; –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç search_direction
                 
0000f2 ff41      	sbrs	search_flags, search_direction		;–µ—Å–ª–∏ search_direction = 1
0000f3 c005      	rjmp	OWS_do_2_1
                 
                 	; –¢–æ–≥–¥–∞, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∏—Ç –≤ 1: ROM_NO[rom_byte_number] = ROM_NO[rom_byte_number] OR rom_byte_mask;
                 
0000f4 8108      	ld 		r16, y								; –ü–æ–ª—É—á–∏–ª–∏ –≤ r16 ROM_NO[rom_byte_number]
0000f5 9110 0063 	lds		r17, rom_byte_mask					; –ø–æ–ª—É—á–∏–ª–∏ –≤ r17 rom_byte_mask
0000f7 2b01      	or 		r16, r17							; —Å–¥–µ–ª–∞–ª–∏ ROM_NO[rom_byte_number] OR rom_byte_mask
                 	
0000f8 c006      	rjmp 	OWS_do_2_2
                 
                 			
                 OWS_do_2_1:										
                 	; –∏–Ω–∞—á–µ search_direction = 1
                 	; –¢–æ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –±–∏—Ç –≤ 0: ROM_NO[rom_byte_number] = ROM_NO[rom_byte_number] AND (rom_byte_mask XOR FF);
0000f9 9110 0063 	lds		r17, rom_byte_mask					; –ø–æ–ª—É—á–∏–ª–∏ –≤ r17 rom_byte_mask
0000fb ef0f      	ldi		r16, 0xFF
0000fc 2710      	EOR		R17, R16							; –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ R17
                 
0000fd 8108      	ld 		r16, y								; –ü–æ–ª—É—á–∏–ª–∏ –≤ r16 ROM_NO[rom_byte_number]
0000fe 2301      	AND		r16, r17							; —Å–¥–µ–ª–∞–ª–∏ ROM_NO[rom_byte_number] AND (rom_byte_mask XOR FF)
                 
                 
                 OWS_do_2_2:
0000ff 8308      	ST 		y, r16								; –∑–∞–ø–∏—Å–∞–ª–∏ –Ω–∞–∑–∞–¥ –≤ ROM_NO[rom_byte_number]
                 
000100 9408      	sec											; –æ—Ç—Å—ã–ª–∞–µ–º –±–∏—Ç search_direction –≤ —à–∏–Ω—É, —á—Ç–æ–±—ã –∑–∞—Ç–∫–Ω—É—Ç—å —Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —É –∫–æ—Ç–æ—Ä—ã—Ö —ç—Ç–æ—Ç –±–∏—Ç –Ω–µ —Ç–∞–∫–æ–π
000101 ff41      	sbrs	search_flags, search_direction		
000102 9488      	clc
000103 94f8      	cli
000104 df67      	rcall 	OWWriteBit							
000105 9478      	sei
                 
000106 9100 0061 	lds 	r16, id_bit_number					; id_bit_number++;
000108 9503      	inc 	r16
000109 9300 0061 	sts 	id_bit_number, r16
                 
00010b 9100 0063 	lds 	r16, rom_byte_mask					; –°–¥–≤–∏–≥–∞–µ–º –≤–ª–µ–≤–æ rom_byte_mask –Ω–∞ 1 –±–∏—Ç
00010d 0f00      	lsl 	r16
00010e 9300 0063 	sts 	rom_byte_mask, r16
000110 f459      	brne 	OWS_do_end							; –µ—Å–ª–∏ –µ—â–µ –Ω–µ –≤—Å–µ –±–∏—Ç—ã –≤ —Ç–µ–∫—É—â–µ–º –±–∞–π—Ç–µ –ø—Ä–æ—à–ª–∏ - —Ç–æ –±–µ–≥–æ–º –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é —Ü–∏–∫–ª–∞ –ø–æ–∏—Å–∫–∞
                 
                 	; –∏–Ω–∞—á–µ –¥–æ–±–∞–≤–ª—è–µ–º CRC —ç—Ç–æ–≥–æ –±–∞–π—Ç–∞ –≤ –æ–±—â–µ–µ CRC
                 
000111 d03b      	rcall	Calc_ROM_NO							; –ü–æ–ª—É—á–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ROM_NO[rom_byte_number]
000112 8108      	ld		r16, y								; –ü–æ–ª—É—á–∏–ª–∏ –≤ r16 ROM_NO[rom_byte_number]
                 
000113 d051      	rcall 	docrc8								; CRC –≥–æ—Ç–æ–≤–∞
                 
000114 9100 0062 	lds 	r16, rom_byte_number				; rom_byte_number = rom_byte_number+1;
000116 9503      	inc 	r16
000117 9300 0062 	sts 	rom_byte_number, r16
                 
000119 e001      	ldi 	r16, 1								; –°–±—Ä–∞—Å—ã–≤–∞–µ–º –±–∏—Ç–æ–≤—É—é –º–∞—Å–∫—É –≤ 1
00011a 9300 0063 	sts 	rom_byte_mask, r16
                 
                 
                 OWS_do_end:										; –ö—Ä—É—Ç–∏–º —Ü–∏–∫–ª –ø–æ–∫–∞ rom_byte_number < 8
00011c 9100 0062 	lds 	r16, rom_byte_number
00011e 3008      	cpi 	r16, 8
00011f f408      	brcc 	OWS_do_break
000120 cfa4      	rjmp 	OWS_do
                 
                 
                 	; –µ—Å–ª–∏ –ø–æ–∏—Å–∫ –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ, —Ç–æ–≥–¥–∞ id_bit_number –±—É–¥–µ—Ç –±–æ–ª—å—à–µ 64 –∏ crc8 –±—É–¥–µ—Ç —Ä–∞–≤–Ω–∞ 0
                 OWS_do_break:
000121 9100 0061 	lds 	r16, id_bit_number
000123 3401      	cpi 	r16, 65
000124 f408      	brcc 	OWS_bo_break_0
000125 c017      	rjmp 	OWSItWasLastDevice					; id_bit_number < 65, –æ—à–∏–±–∫–∞!
                 
                 
                 OWS_bo_break_0:
000126 9100 0067 	lds 	r16, crc8
000128 2300      	tst 	r16
000129 f009      	breq 	OWS_bo_break_00
00012a c012      	rjmp 	OWSItWasLastDevice					; crc8 –Ω–µ —Ä–∞–≤–Ω–æ 0, –æ—à–∏–±–∫–∞!
                 
                 
                 OWS_bo_break_00:
                 	; –ü–æ–∏—Å–∫ —É–¥–∞–ª—Å—è, —É—Å—Ç–∞–Ω–æ–≤–∏–º —Ñ–ª–∞–≥–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
00012b 9100 0064 	lds 	r16, last_zero						; LastDiscrepancy = last_zero;
00012d 9300 0065 	sts 	LastDiscrepancy, r16
                 
00012f 2300      	tst		r16									; –µ—Å–ª–∏ LastDiscrepancy = 0
000130 f409      	brne 	OWS_do_break_1
                 
000131 6044      	sbr		search_flags, 1<<LastDeviceFlag		; —Ç–æ —ç—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–≤–∞–π—Å –Ω–∞ –ª–∏–Ω–∏–∏, LastDeviceFlag = 1
                 
                 
                 OWS_do_break_1:
000132 9100 0066 	lds		r16, LastFamilyDiscrepancy
000134 9110 0065 	lds		r17, LastDiscrepancy
000136 1701      	cp		r16,r17								; –µ—Å–ª–∏ LastFamilyDiscrepancy == LastDiscrepancy
000137 f419      	brne	OWS_do_break_2
                 
000138 2700      	clr 	r16
000139 9300 0066 	sts		LastFamilyDiscrepancy, r16			; —Ç–æ LastFamilyDiscrepancy = 0
                 
                 
                 OWS_do_break_2:
00013b 6041      	sbr		search_flags, 1<<search_result		; search_result = 1, —É—Ä–∞, –≤—Å–µ –û–ö!
00013c c00d      	rjmp	OWN_Return
                 
                 
                 OWSItWasLastDevice:
00013d fd40      	sbrc	search_flags, search_result			; –µ—Å–ª–∏ search_result = 0
00013e c00b      	rjmp	OWN_Return
                 
00013f 9100 0068 	lds		r16, ROM_NO
000141 2300      	tst 	r16
000142 f439      	brne 	OWN_Return
                 	
                 	; –¢–æ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–∫, —á—Ç–æ–±—ã —Å–ª–µ–¥—É—é—â–∏–π –≤—ã–∑–æ–≤ —ç—Ç–æ–π –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –±—ã–ª —Ä–∞–≤–Ω–æ—Å–∏–ª–µ–º –≤—ã–∑–æ–≤—É OWFirst
000143 7f4d      	cbr		search_flags, LastDeviceFlag		; LastDeviceFlag = 0
000144 2700      	clr 	r16
000145 9300 0065 	sts 	LastDiscrepancy, r16				; LastDiscrepancy = 0	
000147 9300 0066 	sts 	LastFamilyDiscrepancy, r16			; LastFamilyDiscrepancy = 0
000149 7f4e      	cbr		search_flags, 1<<search_result		; search_result = 0
                 
                 
                 OWN_Return:
00014a 9340 0060 	sts		stored_search_flags, search_flags	; –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–ª–∞–≥–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–∏—Å–∫–∞
00014c 9508      	ret
                 
                 
                 
                 
                 
                 ;*********************************************************************		
                 ; 	–í—ã—á–∏—Å–ª—è–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ROM_NO[rom_byte_number]
                 ;
                 
                 calc_ROM_NO:
00014d e0d0      	ldi		yh, high(ROM_NO)					; —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ROM_NO
00014e e6c8      	ldi		yl, low (ROM_NO)
00014f 9100 0062 	lds		r16, rom_byte_number				; –ø—Ä–∏–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–º—É rom_byte_number
000151 2711      	clr		r17
000152 0fc0      	add		yl, r16
000153 1fd1      	adc		yh, r17
000154 9508      	ret
                 
                 
                 
                 
                 
                 ;*********************************************************************		
                 ;   –û—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞ ROM_NO
                 ; 	
                 OWClearROM_NO:
                 
000155 e0d0      	ldi yh, high(ROM_NO)			; —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ROM_NO
000156 e6c8      	ldi yl, low (ROM_NO)
                 
000157 e008      	ldi r16, 8
000158 2711      	clr r17
                 
                 OWCRN:
000159 9319      	st y+, r17
00015a 950a      	dec r16
00015b f7e9      	brne OWCRN
                 			   
00015c 9508      	ret
                 
                 
                 ;*********************************************************************		
                 ;   –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±—É—Ñ–µ—Ä ROM_NO (–¥–ª—è –∫–æ–º–∞–Ω–¥—ã MATCH)
                 ; 	
                 OWSendROM_NO:
00015d e0d0      	ldi yh, high(ROM_NO)			; —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ROM_NO
00015e e6c8      	ldi yl, low (ROM_NO)
00015f e018      	ldi r17, 8						;—Å—á–µ—Ç—á–∏–∫ –±–∞–π—Ç
                 
                 OWSNDRN:
000160 9109      	ld r16, y+
000161 df17      	rcall	OWWriteByte
                 
000162 951a      	dec r17
000163 f7e1      	brne OWSNDRN
                 			   
000164 9508      	ret
                 
                 
                 
                 ;*********************************************************************		
                 ;   –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–¥—Å—á–µ—Ç CRC –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É 1-Wire
                 ; 	–≤—Ö–æ–¥: r16 - —Å—á–∏—Ç–∞–Ω–Ω—ã–π –±–∞–π—Ç
                 ; 	–≤—ã—Ö–æ–¥: CRC - —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Å—á–∏—Ç–∞–Ω–Ω—É—é —Å—É–º–º—É
                 ; 	–ø–æ—Ä—Ç–∏—Ç: —Ä–µ–≥–∏—Å—Ç—Ä Z
                 ; 	–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –≤—ã–∑–æ–≤–æ–º CRC –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω—É–ª–∏—Ç—å
                 
                 docrc8:
000165 9110 0067 	lds		r17, CRC8
000167 2701      	eor		r16, r17
                 	
000168 e0f1      	ldi		ZH, high(CRCtable)
000169 e7e4      	ldi		ZL, low(CRCtable)
00016a 9488      	clc
00016b 1fee      	rol		ZL
00016c 1fff      	rol		ZH
00016d 0fe0      	add		ZL, r16
00016e e010      	ldi		r17,0
00016f 1ff1      	adc		ZH, r17
000170 9104      	lpm		r16, z
000171 9300 0067 	sts		CRC8, r16
000173 9508      	ret
                 
                 
                 CRCtable:
                 ; —Ç–∞–±–ª–∏—Ü–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã CRC-8
000174 5e00
000175 e2bc
000176 3f61
000177 83dd
000178 9cc2
000179 207e
00017a fda3
00017b 411f      	.db		0, 94, 188, 226, 97, 63, 221, 131, 194, 156, 126, 32, 163, 253, 31, 65
00017c c39d
00017d 7f21
00017e a2fc
00017f 1e40
000180 015f
000181 bde3
000182 603e
000183 dc82      	.db 	157, 195, 33, 127, 252, 162, 64, 30, 95, 1, 227, 189, 62, 96, 130, 220
000184 7d23
000185 c19f
000186 1c42
000187 a0fe
000188 bfe1
000189 035d
00018a de80
00018b 623c      	.db 	35, 125, 159, 193, 66, 28, 254, 160, 225, 191, 93, 3, 128, 222, 60, 98
00018c e0be
00018d 5c02
00018e 81df
00018f 3d63
000190 227c
000191 9ec0
000192 431d
000193 ffa1      	.db 	190, 224, 2, 92, 223, 129, 99, 61, 124, 34, 192, 158, 29, 67, 161, 255
000194 1846
000195 a4fa
000196 7927
000197 c59b
000198 da84
000199 6638
00019a bbe5
00019b 0759      	.db 	70, 24, 250, 164, 39, 121, 155, 197, 132, 218, 56, 102, 229, 187, 89, 7
00019c 85db
00019d 3967
00019e e4ba
00019f 5806
0001a0 4719
0001a1 fba5
0001a2 2678
0001a3 9ac4      	.db 	219, 133, 103, 57, 186, 228, 6, 88, 25, 71, 165, 251, 120, 38, 196, 154
0001a4 3b65
0001a5 87d9
0001a6 5a04
0001a7 e6b8
0001a8 f9a7
0001a9 451b
0001aa 98c6
0001ab 247a      	.db 	101, 59, 217, 135, 4, 90, 184, 230, 167, 249, 27, 69, 198, 152, 122, 36
0001ac a6f8
0001ad 1a44
0001ae c799
0001af 7b25
0001b0 643a
0001b1 d886
0001b2 055b
0001b3 b9e7      	.db 	248, 166, 68, 26, 153, 199, 37, 123, 58, 100, 134, 216, 91, 5, 231, 185
0001b4 d28c
0001b5 6e30
0001b6 b3ed
0001b7 0f51
0001b8 104e
0001b9 acf2
0001ba 712f
0001bb cd93      	.db 	140, 210, 48, 110, 237, 179, 81, 15, 78, 16, 242, 172, 47, 113, 147,205
0001bc 4f11
0001bd f3ad
0001be 2e70
0001bf 92cc
0001c0 8dd3
0001c1 316f
0001c2 ecb2
0001c3 500e      	.db 	17, 79, 173, 243, 112, 46, 204, 146, 211, 141, 111, 49, 178, 236, 14, 80
0001c4 f1af
0001c5 4d13
0001c6 90ce
0001c7 2c72
0001c8 336d
0001c9 8fd1
0001ca 520c
0001cb eeb0      	.db 	175, 241, 19, 77, 206, 144, 114, 44, 109, 51, 209, 143, 12, 82, 176, 238
0001cc 6c32
0001cd d08e
0001ce 0d53
0001cf b1ef
0001d0 aef0
0001d1 124c
0001d2 cf91
0001d3 732d      	.db 	50, 108, 142, 208, 83, 13, 239, 177, 240, 174, 76, 18, 145, 207, 45, 115
0001d4 94ca
0001d5 2876
0001d6 f5ab
0001d7 4917
0001d8 5608
0001d9 eab4
0001da 3769
0001db 8bd5      	.db 	202, 148, 118, 40, 171, 245, 23, 73, 8, 86, 180, 234, 105, 55, 213, 139
0001dc 0957
0001dd b5eb
0001de 6836
0001df d48a
0001e0 cb95
0001e1 7729
0001e2 aaf4
0001e3 1648      	.db 	87, 9, 235, 181, 54, 104, 138, 212, 149, 203, 41, 119, 244, 170, 72, 22
0001e4 b7e9
0001e5 0b55
0001e6 d688
0001e7 6a34
0001e8 752b
0001e9 c997
0001ea 144a
0001eb a8f6      	.db 	233, 183, 85, 11, 136, 214, 52, 106, 43, 117, 151, 201, 74, 20, 246, 168
0001ec 2a74
0001ed 96c8
0001ee 4b15
0001ef f7a9
0001f0 e8b6
0001f1 540a
0001f2 89d7
0001f3 356b      	.db 	116, 42, 200, 150, 21, 75, 169, 247, 182, 232, 10, 84, 215, 137, 107, 53
                 
                 
                 
                 
                 
                 ; –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –ø–æ–∏—Å–∫–∞
                 .dseg
                 
000060 00        stored_search_flags:	.db	0
000061 00        id_bit_number: 			.db 0
000062 00        rom_byte_number:		.db 0
000063 00        rom_byte_mask:			.db 0
000064 00        last_zero:				.db 0
000065 00        LastDiscrepancy:		.db 0
000066 00        LastFamilyDiscrepancy:	.db 0
000067 00        crc8:					.db 0
000068           ROM_NO:					.byte 8
                 
                 
                 .cseg
                 
                 
                 
                 


RESOURCE USE INFORMATION
------------------------

Notice:
The register and instruction counts are symbol table hit counts,
and hence implicitly used resources are not counted, eg, the
'lpm' instruction without operands implicitly uses r0 and z,
none of which are counted.

x,y,z are separate entities in the symbol table and are
counted separately from r26..r31 here.

.dseg memory usage only counts static data declared with .byte

"ATtiny13" register use summary:
r0 :   0 r1 :   0 r2 :   0 r3 :   0 r4 :   0 r5 :   0 r6 :   0 r7 :   0 
r8 :   0 r9 :   0 r10:   0 r11:   0 r12:   0 r13:   0 r14:   0 r15:   0 
r16:  93 r17:  44 r18:   0 r19:   0 r20:  19 r21:   0 r22:   0 r23:   0 
r24:   0 r25:   4 r26:  12 r27:  12 r28:   4 r29:   4 r30:   3 r31:   3 
x  :   0 y  :   7 z  :   1 
Registers used: 12 out of 35 (34.3%)

"ATtiny13" instruction use summary:
.lds  :   0 .sts  :   0 adc   :   2 add   :   2 adiw  :   0 and   :   2 
andi  :   2 asr   :   0 bclr  :   0 bld   :   0 brbc  :   0 brbs  :   0 
brcc  :   5 brcs  :   0 break :   0 breq  :   4 brge  :   0 brhc  :   0 
brhs  :   0 brid  :   0 brie  :   0 brlo  :   6 brlt  :   0 brmi  :   0 
brne  :  15 brpl  :   0 brsh  :   0 brtc  :   1 brts  :   1 brvc  :   0 
brvs  :   0 bset  :   0 bst   :   0 cbi   :  11 cbr   :   8 clc   :   3 
clh   :   0 cli   :   3 cln   :   0 clr   :   9 cls   :   0 clt   :   2 
clv   :   0 clz   :   0 com   :   3 cp    :   3 cpc   :   0 cpi   :  11 
cpse  :   0 dec   :   3 eor   :   2 icall :   0 ijmp  :   0 in    :   0 
inc   :   5 ld    :   5 ldd   :   0 ldi   :  47 lds   :  19 lpm   :   2 
lsl   :   1 lsr   :   0 mov   :   1 movw  :   0 neg   :   0 nop   :   0 
or    :   2 ori   :   0 out   :   3 pop   :   3 push  :   3 rcall :  33 
ret   :  22 reti  :   9 rjmp  :  16 rol   :   4 ror   :   2 sbc   :   0 
sbci  :   0 sbi   :   8 sbic  :   1 sbis  :   1 sbiw  :   1 sbr   :   4 
sbrc  :   3 sbrs  :   2 sec   :   2 seh   :   0 sei   :   3 sen   :   0 
ser   :   0 ses   :   0 set   :   2 sev   :   0 sez   :   0 sleep :   0 
spm   :   0 st    :   2 std   :   0 sts   :  22 sub   :   0 subi  :   0 
swap  :   1 tst   :   5 wdr   :   0 
Instructions used: 52 out of 105 (49.5%)

"ATtiny13" memory use summary [bytes]:
Segment   Begin    End      Code   Data   Used    Size   Use%
---------------------------------------------------------------
[.cseg] 0x000000 0x0003e8    744    256   1000    1024  97.7%
[.dseg] 0x000060 0x000070      0     16     16      64  25.0%
[.eseg] 0x000000 0x000000      0      0      0      64   0.0%

Assembly complete, 0 errors, 0 warnings
